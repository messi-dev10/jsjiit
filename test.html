<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>jsjiit</title>
</head>

<body>
  <label for="user">Username</label>
  <input id="user" name="user" type="text"></input>
  <label for="pass">Password</label>
  <input id="pass" name="pass" type="text"></input>
  <button onclick="main();">Submit</button>

  <script type="module">
    // import { WebPortal } from "https://cdn.jsdelivr.net/npm/jsjiit@0.0.11/dist/jsjiit.esm.js"; // exact version
    import { WebPortal } from "https://cdn.jsdelivr.net/npm/jsjiit/dist/jsjiit.esm.js"; // latest version
    window.main = async function main() {
      let user = document.getElementById("user");
      let pass = document.getElementById("pass");
      let w = new WebPortal();
      await w.student_login(user.value, pass.value);

      const meta = await w.get_attendance_meta()
      let sem = meta.latest_semester();
      let header = meta.latest_header();
      console.log("Latest semester:", sem);
      console.log("Latest header:", header);
      let attendance = await w.get_attendance(header, sem);
      console.log(attendance);

      // let subjectIndex = 1;
      // let subjectid = attendance["studentattendancelist"][subjectIndex]["subjectid"];
      // let individualsubjectcode = attendance["studentattendancelist"][subjectIndex]["individualsubjectcode"];
      // const possibleComponentCodes = ["Lsubjectcomponentid", "Psubjectcomponentid", "Tsubjectcomponentid"]
      // let subjectcomponentids = [];
      // for (let possibleComponentCode of possibleComponentCodes) {
      //   if (attendance["studentattendancelist"][subjectIndex][possibleComponentCode]) {
      //     subjectcomponentids.push(attendance["studentattendancelist"][subjectIndex][possibleComponentCode]);
      //   }
      // }
      // let subjectAttendance = await w.get_subject_daily_attendance(sem, subjectid, individualsubjectcode, subjectcomponentids);
      // console.log(subjectAttendance);

      let registerdSems = await w.get_registered_semesters();
      let latestSem = registerdSems[0];
      let registeredSubjects = await w.get_registered_subjects_and_faculties(latestSem);
      console.log(registeredSubjects);
      console.log("--------------------------------");
      let examSems = await w.get_semesters_for_exam_events();
      console.log(examSems);
      console.log(typeof examSems);
      latestSem = examSems[0];
      let examEvents = await w.get_exam_events(latestSem);
      console.log(examEvents);
      let examSchedule = await w.get_exam_schedule(examEvents[0]);
      console.log(examSchedule);


      let gradeCardSems = await w.get_semesters_for_grade_card();
      console.log(gradeCardSems);
      let gradeCard = await w.get_grade_card(gradeCardSems[0]);
      console.log(gradeCard);

      let sgpaCgpa = await w.get_sgpa_cgpa();
      console.log(sgpaCgpa);

      let personalInfo = await w.get_personal_info();
      console.log(personalInfo);

      let marksSems = await w.get_semesters_for_marks();
      latestSem = marksSems[0];
      let marks = await w.download_marks(latestSem);
      console.log(marks);

    }
  </script>
</body>

</html>